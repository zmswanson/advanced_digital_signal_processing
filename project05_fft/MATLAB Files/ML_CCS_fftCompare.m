N = 256;
Nby2 = N/2;
fs = 48000;
fsby2 = fs/2;

f = 0:fs/N:fsby2;

CCS_sig = [-7970.0
-9066.0
-9968.0
-10664.0
-11138.0
-11374.0
-11374.0
-11142.0
-10660.0
-9968.0
-9064.0
-7970.0
-6718.0
-5322.0
-3822.0
-2244.0
-628.0
996.0
2584.0
4114.0
5542.0
6852.0
8004.0
8966.0
9732.0
10282.0
10592.0
10674.0
10516.0
10124.0
9504.0
8670.0
7640.0
6432.0
5090.0
3622.0
2076.0
470.0
-1146.0
-2748.0
-4298.0
-5756.0
-7114.0
-8312.0
-9340.0
-10170.0
-10790.0
-11192.0
-11344.0
-11272.0
-10956.0
-10416.0
-9654.0
-8696.0
-7550.0
-6252.0
-4824.0
-3294.0
-1706.0
-86.0
1526.0
3100.0
4600.0
5990.0
7246.0
8348.0
9246.0
9932.0
10406.0
10644.0
10642.0
10392.0
9918.0
9220.0
8316.0
7214.0
5958.0
4570.0
3068.0
1492.0
-122.0
-1738.0
-3330.0
-4846.0
-6264.0
-7570.0
-8704.0
-9664.0
-10420.0
-10966.0
-11280.0
-11350.0
-11192.0
-10806.0
-10190.0
-9354.0
-8336.0
-7132.0
-5788.0
-4326.0
-2774.0
-1168.0
448.0
2052.0
3604.0
5076.0
6430.0
7632.0
8656.0
9494.0
10122.0
10514.0
10674.0
10600.0
10280.0
9740.0
8976.0
8008.0
6862.0
5566.0
4132.0
2608.0
1022.0
-602.0
-2216.0
-3784.0
-5282.0
-6666.0
-7928.0
-9016.0
-9914.0
-10612.0
-11084.0
-11322.0
-11324.0
-11092.0
-10626.0
-9932.0
-9038.0
-7952.0
-6696.0
-5314.0
-3812.0
-2244.0
-632.0
986.0
2578.0
4098.0
5524.0
6822.0
7968.0
8926.0
9690.0
10236.0
10542.0
10626.0
10460.0
10072.0
9452.0
8622.0
7598.0
6396.0
5062.0
3608.0
2064.0
460.0
-1156.0
-2754.0
-4300.0
-5764.0
-7110.0
-8310.0
-9336.0
-10166.0
-10790.0
-11184.0
-11348.0
-11270.0
-10958.0
-10420.0
-9658.0
-8700.0
-7556.0
-6252.0
-4826.0
-3302.0
-1708.0
-96.0
1520.0
3098.0
4604.0
5990.0
7246.0
8348.0
9244.0
9934.0
10404.0
10654.0
10654.0
10408.0
9942.0
9248.0
8346.0
7262.0
6006.0
4620.0
3128.0
1548.0
-60.0
-1682.0
-3274.0
-4792.0
-6216.0
-7522.0
-8662.0
-9632.0
-10394.0
-10944.0
-11258.0
-11348.0
-11196.0
-10806.0
-10196.0
-9370.0
-8350.0
-7160.0
-5826.0
-4366.0
-2824.0
-1224.0
392.0
1998.0
3546.0
5014.0
6370.0
7580.0
8610.0
9452.0
10082.0
10488.0
10650.0
10582.0
10270.0
9732.0
8970.0
8006.0
6864.0
5562.0
4140.0
2610.0
1024.0
-596.0
-2208.0
-3782.0
-5278.0
-6662.0
];

CCS_fft = [354.0
1.0
1.0
6.0
6.0
3.0
5510.0
7.0
2.0
1.0
3.0
2.0
1.0
2.0
0.0
1.0
1.0
1.0
1.0
1.0
1.0
1.0
0.0
1.0
1.0
1.0
0.0
0.0
0.0
0.0
1.0
1.0
1.0
0.0
1.0
1.0
1.0
1.0
0.0
1.0
1.0
1.0
1.0
1.0
0.0
1.0
0.0
0.0
1.0
1.0
1.0
1.0
1.0
0.0
0.0
0.0
0.0
0.0
0.0
0.0
1.0
1.0
1.0
0.0
0.0
0.0
0.0
1.0
1.0
0.0
1.0
1.0
0.0
0.0
1.0
1.0
1.0
1.0
1.0
1.0
1.0
0.0
0.0
1.0
0.0
1.0
1.0
1.0
1.0
1.0
1.0
1.0
1.0
0.0
0.0
1.0
1.0
0.0
1.0
1.0
1.0
1.0
1.0
1.0
0.0
1.0
1.0
1.0
1.0
0.0
1.0
1.0
1.0
1.0
1.0
1.0
1.0
0.0
1.0
1.0
0.0
0.0
1.0
0.0
0.0
0.0
0.0
1.0
0.0
];

CCS_sig = CCS_sig/2^16;
CCS_fft = CCS_fft/2^16;
ML_fft = abs(fft(CCS_sig, N))/N;

plot(f, CCS_fft, f, ML_fft(1:(Nby2+1)));
immse(CCS_fft,ML_fft(1:(Nby2+1)))

LPF = [56;6;-1;-13;-31;-55;-87;-125;-168;-217;-267;-318;-366;-408;-438;-454;-450;-423;-368;-282;-163;-9;181;405;661;946;1255;1581;1917;2254;2585;2899;3188;3444;3659;3827;3941;4000;4000;3941;3827;3659;3444;3188;2899;2585;2254;1917;1581;1255;946;661;405;181;-9;-163;-282;-368;-423;-450;-454;-438;-408;-366;-318;-267;-217;-168;-125;-87;-55;-31;-13;-1;6;56];
HPF = [-342;-36;-28;-14;8;37;72;113;158;206;254;301;342;375;398;405;396;366;313;235;131;-1;-160;-345;-555;-786;-1037;-1301;-1576;-1854;-2131;-2400;-2655;-2891;-3101;-3280;-3425;-3531;-3595;32767;-3595;-3531;-3425;-3280;-3101;-2891;-2655;-2400;-2131;-1854;-1576;-1301;-1037;-786;-555;-345;-160;-1;131;235;313;366;396;405;398;375;342;301;254;206;158;113;72;37;8;-14;-28;-36;-342];
% 300 Hz LPF transition to 1800 Hz, 70 coefficients
LPF2 = [-140;-41;-43;-41;-36;-26;-10;12;42;80;127;184;250;326;412;508;613;727;848;976;1109;1246;1384;1523;1659;1792;1918;2037;2145;2242;2325;2394;2446;2481;2499;2499;2481;2446;2394;2325;2242;2145;2037;1918;1792;1659;1523;1384;1246;1109;976;848;727;613;508;412;326;250;184;127;80;42;12;-10;-26;-36;-41;-43;-41;-140];
% 2400 Hz HPF transition to 1200 Hz, 70 coefficients
HPF2 = [1212;56;26;-25;-93;-175;-264;-353;-434;-499;-538;-543;-510;-432;-309;-141;66;305;565;832;1086;1312;1486;1587;1593;1480;1224;798;167;-724;-1972;-3789;-6738;-12921;-32768;32767;12921;6738;3789;1972;724;-167;-798;-1224;-1480;-1593;-1587;-1486;-1312;-1086;-832;-565;-305;-66;141;309;432;510;543;538;499;434;353;264;175;93;25;-26;-56;-1212];
% 1200 Hz LPF transition to 2400 Hz, 128 coefficients
LPF3 = [-3;-4;-6;-10;-13;-18;-22;-28;-33;-38;-43;-47;-50;-51;-50;-46;-40;-31;-18;-3;14;34;55;77;98;117;132;143;149;147;137;119;92;56;13;-38;-93;-152;-210;-266;-316;-357;-384;-395;-387;-357;-304;-225;-121;7;158;330;519;721;931;1143;1351;1550;1734;1897;2034;2140;2214;2251;2251;2214;2140;2034;1897;1734;1550;1351;1143;931;721;519;330;158;7;-121;-225;-304;-357;-387;-395;-384;-357;-316;-266;-210;-152;-93;-38;13;56;92;119;137;147;149;143;132;117;98;77;55;34;14;-3;-18;-31;-40;-46;-50;-51;-50;-47;-43;-38;-33;-28;-22;-18;-13;-10;-6;-4;-3];
% 3600 Hz HPF transition to 2400 Hz, 128 coefficients
HPF3 = [-3;109;-59;-49;-38;-26;-13;2;17;32;42;46;42;29;8;-18;-44;-66;-79;-78;-61;-31;11;56;97;126;134;119;79;18;-54;-126;-184;-216;-213;-169;-88;20;139;249;328;358;327;231;78;-112;-311;-484;-597;-618;-529;-324;-16;360;757;1112;1352;1404;1192;635;-388;-2148;-5666;-20419;20419;5666;2148;388;-635;-1192;-1404;-1352;-1112;-757;-360;16;324;529;618;597;484;311;112;-78;-231;-327;-358;-328;-249;-139;-20;88;169;213;216;184;126;54;-18;-79;-119;-134;-126;-97;-56;-11;31;61;78;79;66;44;18;-8;-29;-42;-46;-42;-32;-17;-2;13;26;38;49;59;-109;3];