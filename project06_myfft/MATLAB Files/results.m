myData = [707.0
0.0
719.0
-59.0
751.0
-115.0
806.0
-180.0
901.0
-261.0
1048.0
-373.0
1301.0
-539.0
1787.0
-840.0
3031.0
-1574.0
11820.0
-6663.0
-5792.0
3491.0
-2282.0
1454.0
-1410.0
939.0
-1019.0
703.0
-798.0
565.0
-657.0
475.0
-559.0
412.0
-489.0
362.0
-435.0
325.0
-393.0
294.0
-360.0
267.0
-333.0
245.0
-312.0
228.0
-292.0
211.0
-277.0
197.0
-263.0
185.0
-252.0
173.0
-243.0
163.0
-233.0
154.0
-225.0
145.0
-219.0
135.0
-213.0
129.0
-205.0
123.0
-201.0
116.0
-196.0
110.0
-192.0
105.0
-187.0
99.0
-185.0
93.0
-183.0
88.0
-180.0
83.0
-178.0
79.0
-175.0
74.0
-172.0
69.0
-171.0
66.0
-170.0
62.0
-168.0
57.0
-166.0
56.0
-165.0
51.0
-163.0
48.0
-163.0
44.0
-162.0
42.0
-161.0
37.0
-160.0
34.0
-159.0
31.0
-158.0
29.0
-158.0
26.0
-158.0
22.0
-156.0
20.0
-157.0
16.0
-157.0
13.0
-157.0
10.0
-157.0
7.0
-157.0
5.0
-155.0
1.0
-155.0
0.0
-155.0
-3.0
-157.0
-5.0
-156.0
-8.0
-157.0
-11.0
-156.0
-15.0
-157.0
-17.0
-157.0
-20.0
-157.0
-22.0
-158.0
-25.0
-158.0
-29.0
-160.0
-32.0
-160.0
-35.0
-161.0
-39.0
-162.0
-41.0
-163.0
-45.0
-163.0
-48.0
-165.0
-52.0
-167.0
-55.0
-169.0
-58.0
-170.0
-63.0
-171.0
-67.0
-172.0
-70.0
-174.0
-75.0
-177.0
-79.0
-181.0
-85.0
-182.0
-89.0
-185.0
-95.0
-187.0
-100.0
-193.0
-105.0
-195.0
-111.0
-201.0
-117.0
-205.0
-123.0
-213.0
-130.0
-218.0
-136.0
-224.0
-145.0
-233.0
-155.0
-243.0
-163.0
-251.0
-174.0
-262.0
-185.0
-276.0
-199.0
-293.0
-212.0
-310.0
-229.0
-333.0
-246.0
-360.0
-268.0
-394.0
-293.0
-434.0
-326.0
-487.0
-363.0
-559.0
-412.0
-657.0
-476.0
-798.0
-566.0
-1019.0
-703.0
-1410.0
-940.0
-2281.0
-1455.0
-5792.0
-3493.0
11820.0
6662.0
3032.0
1572.0
1788.0
838.0
1301.0
538.0
1049.0
371.0
901.0
260.0
807.0
179.0
751.0
113.0
719.0
57.0];

tiData = [709.0
0.0
719.0
-54.0
750.0
-112.0
806.0
-176.0
900.0
-258.0
1048.0
-369.0
1301.0
-536.0
1789.0
-836.0
3032.0
-1570.0
11820.0
-6660.0
-5792.0
3494.0
-2281.0
1456.0
-1411.0
942.0
-1018.0
706.0
-798.0
568.0
-656.0
477.0
-558.0
413.0
-489.0
364.0
-436.0
326.0
-394.0
296.0
-361.0
270.0
-333.0
248.0
-311.0
230.0
-293.0
213.0
-276.0
199.0
-264.0
187.0
-252.0
176.0
-241.0
164.0
-233.0
155.0
-225.0
146.0
-217.0
138.0
-211.0
130.0
-206.0
124.0
-202.0
117.0
-198.0
111.0
-192.0
105.0
-189.0
99.0
-186.0
93.0
-183.0
89.0
-180.0
84.0
-178.0
80.0
-175.0
76.0
-174.0
71.0
-171.0
67.0
-169.0
63.0
-169.0
59.0
-168.0
56.0
-166.0
52.0
-164.0
49.0
-163.0
45.0
-162.0
42.0
-161.0
39.0
-161.0
36.0
-159.0
32.0
-158.0
31.0
-158.0
25.0
-159.0
23.0
-158.0
21.0
-158.0
18.0
-156.0
14.0
-156.0
13.0
-156.0
8.0
-155.0
5.0
-156.0
3.0
-155.0
0.0
-155.0
-4.0
-156.0
-6.0
-156.0
-10.0
-156.0
-12.0
-156.0
-15.0
-157.0
-18.0
-157.0
-22.0
-158.0
-24.0
-158.0
-28.0
-158.0
-30.0
-161.0
-32.0
-159.0
-36.0
-162.0
-40.0
-162.0
-42.0
-164.0
-45.0
-164.0
-49.0
-165.0
-52.0
-166.0
-56.0
-168.0
-60.0
-169.0
-64.0
-171.0
-68.0
-173.0
-72.0
-175.0
-77.0
-178.0
-81.0
-180.0
-85.0
-182.0
-90.0
-185.0
-94.0
-189.0
-99.0
-191.0
-106.0
-197.0
-112.0
-201.0
-118.0
-206.0
-124.0
-210.0
-131.0
-216.0
-139.0
-224.0
-147.0
-231.0
-155.0
-240.0
-165.0
-251.0
-175.0
-262.0
-188.0
-276.0
-200.0
-293.0
-214.0
-310.0
-231.0
-333.0
-249.0
-359.0
-271.0
-393.0
-297.0
-434.0
-328.0
-488.0
-366.0
-558.0
-413.0
-655.0
-479.0
-796.0
-570.0
-1017.0
-707.0
-1409.0
-942.0
-2281.0
-1458.0
-5790.0
-3497.0
11822.0
6659.0
3033.0
1569.0
1790.0
835.0
1304.0
534.0
1050.0
366.0
900.0
255.0
808.0
174.0
751.0
107.0
720.0
51.0];

myData = myData / 2^15;
tiData = tiData / 2^15;
zz = 1;
N = 128;
for yy = 1:N
    myMAG(1, yy) = sqrt(myData(zz, 1)^2 + myData(zz+1, 1)^2);
    tiMAG(1, yy) = sqrt(tiData(zz, 1)^2 + tiData(zz+1, 1)^2);
    zz = zz + 2;
end

fs = 48000;
f1 = 3500;
t2 = 0:1/fs:(N-1)/fs;

s = sin(2*pi*f1*t2);

f = -24000:48000/N:24000-48000/N;

SS = abs(fft(s)/N);

subplot(2,2,3:4)
plot(f, fftshift(SS));

subplot(2,2,1)
plot(f, fftshift(myMAG));

subplot(2,2,2)
plot(f, fftshift(tiMAG));